## Описание

Этот проект представляет собой DAG (Directed Acyclic Graph) для Apache Airflow, который анализирует данные о продажах видеоигр. Он загружает данные из CSV-файла, выполняет различные аналитические задачи и выводит результаты. Основные функции включают определение самой продаваемой игры, самых популярных жанров в Европе, платформ с наибольшим количеством игр, проданных более чем миллионным тиражом в Северной Америке, а также издателей с высокими средними продажами в Японии.

## Установка

1. Убедитесь, что у вас установлен Apache Airflow. Если нет, вы можете установить его с помощью pip:

   ```bash
   pip install apache-airflow
   ```

2. Склонируйте этот репозиторий:

   ```bash
   git clone <URL_репозитория>
   cd <имя_папки_репозитория>
   ```

3. Убедитесь, что у вас установлены необходимые библиотеки:

   ```bash
   pip install pandas
   ```

## Использование

1. Запустите Airflow:

   ```bash
   airflow db init
   airflow webserver --port 8080
   airflow scheduler
   ```

2. Откройте веб-интерфейс Airflow в браузере по адресу `http://localhost:8080`.

3. Найдите DAG с именем `gaming_sales` и запустите его.

## Функции

- `get_data(my_date)`: Загружает данные о продажах видеоигр из CSV-файла и фильтрует их по заданному году.
- `top_sales_game(data)`: Определяет самую продаваемую игру в мире за указанный год.
- `top_sales_game_eu(data)`: Определяет самые продаваемые жанры в Европе за указанный год.
- `more_one_mill(data)`: Определяет платформы с наибольшим количеством игр, проданных более чем миллионным тиражом в Северной Америке.
- `sales_jp(data)`: Определяет издателя с самыми высокими средними продажами в Японии.
- `more_eu_jp(data)`: Подсчитывает количество игр, проданных лучше в Европе, чем в Японии.
- `print_data(...)`: Выводит результаты анализа данных.

## Настройки DAG

- **owner**: FGJ
- **retries**: 2 (количество попыток в случае ошибки)
- **retry_delay**: 5 минут (задержка между попытками)
- **start_date**: 7 октября 2021 года
- **schedule_interval**: Запуск каждый день в 15:00
